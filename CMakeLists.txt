## -------------------------------------------------------------------------------------------------
## Copyright 2018 Joel FALCOU
##
##  Licensed under the MIT License <http://opensource.org/licenses/MIT>.
##  SPDX-License-Identifier: MIT
## -------------------------------------------------------------------------------------------------
cmake_minimum_required(VERSION 3.2)

## -------------------------------------------------------------------------------------------------
## Setup project
## -------------------------------------------------------------------------------------------------
project(spy LANGUAGES CXX)
set(PROJECT_VERSION 1.18.6.0)
set(PROJECT_DOC_DIR   ${PROJECT_SOURCE_DIR}/doc)
set(CMAKE_MODULE_PATH ${CMAKE_MODULE_PATH} ${PROJECT_SOURCE_DIR}/cmake )

## -------------------------------------------------------------------------------------------------
## No in-source build
## -------------------------------------------------------------------------------------------------
if (${PROJECT_SOURCE_DIR} STREQUAL ${PROJECT_BINARY_DIR})
  message(FATAL_ERROR "[spy]: In-source build is not recommend")
endif()

## -------------------------------------------------------------------------------------------------
## Compute version string and mode
## -------------------------------------------------------------------------------------------------
include(parse_revision)

## -------------------------------------------------------------------------------------------------
## Setup Documentation
## -------------------------------------------------------------------------------------------------
add_subdirectory(doc)

## -------------------------------------------------------------------------------------------------
## Options
## -------------------------------------------------------------------------------------------------
option( SPY_BUILD_TEST  "Build tests for spy" ON )

## -------------------------------------------------------------------------------------------------
## Install target
## -------------------------------------------------------------------------------------------------
install(DIRECTORY ${PROJECT_SOURCE_DIR}/include DESTINATION .)

## -------------------------------------------------------------------------------------------------
## Test target
## -------------------------------------------------------------------------------------------------
include(CTest)

if( SPY_BUILD_TEST )
  include(test)
endif()
